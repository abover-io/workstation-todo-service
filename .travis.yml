sudo: required

services:
  - docker

before_script:
  - echo $COOKIE_SECRET

script:
  - docker stack deploy --compose-file=docker-compose.dev.yml fancy-todo-api

after_success:
  - docker exec $(docker ps -q -f name=fancy-todo-api_api) yarn test

env:
  global:
  - secure: Qf9yddTIF1YcGDrnEpF/xtJekuIvdQmo/j8YRFLr9TZF0DkoS0j+hF9RllzlBsr6CTSnSXKUTCuE7SPhL82vCYwTysvb6k4u7jBYODPiQaG6UjT8XhZojBB4e747gUPSYdi5VmE48PODxbMc5b+x65chB8Pilo+fdDEQRd3TW/CZ6R8zK93zDYMBfNivFcCc7YEb6ikc/vVjD9ypl9wPQqAluBss79ffmQ4eUAiwYTjKodkyKIlhoSrQU6FfzMe05N92eUjeddbzqOcX3Lri8LKliG50EWkpOV6+gnkrF6J/G//PPvXniv5UYJLXXuGJ35cQbHPDWIps5LwS0P1Xwme4JwLAZzaYWa3ibFNdLbElk6fteVSVCKGIErHkFDUQUl2ceS+gdmzCem5/5WHG9LnQpV9rBus5qT2v47JWvXePSTz2w3T5lpU7i3WgLPqRPLKAZkGd1dUvAap5AGkqlAPBQUIsXEUhwiuDrAeklJnXPqenukp8IowJT9ZGFIvTbJ6Di32ZY1Xsaka74v8UFF0b7o/OhtYgzCEIQe64OhGBmLJNo3ikeFG9F5I0znqrOBT7RRqBu0x7LKEbFByQRXFIkD/jjPb1v+yxt6t0M3STWzp5jjhhOOzEW+vruxaEdBEjV9yq/cM0TpoVsS8/gmz8bl6UER9EvTorOyeq0Ak=
  - secure: ZDDcacjJTdeasabJWJn5p39bO5LjTfZ4pxjX5CXmjUx4MkDH0VSaQg6qukNLEjdq06ie+RGsgyGkhN+yKKPk+doKNoP3c9qwGyAQDbWS6f9QXcOFsFZHeD8JXf7Py68WrczLreT0s+irwGyf84uOVbESCunDxvQOuChg7wXlJHX9ka+xNigO8GmR2lFzyXaUvagUslClzth842WD/k5VEBUy1/ZeZzwaWW/IBjNGtpzVDad67YW4yeT6D+eRmp3MAdlfqX99ko3aIgDzlC6HotLGsDBQ1LITtN+VGEcWgO232jMFNLNwRE5YTGVCWApUxq7avHz8u032azAEQzXl4SumAyhrq/rQDkxJ4866d12SzqAY/XcXyiYvRLufvUw9zTzaKwD9wG8REdjwbqe2bkD0u1o8aY32TibzLmcb/F7n/E83Iy16uJeXosfJis1moE6rTGLbVitl3UMb3FXIKq25GYYttlH0VTgTHWa7RerJbklpD8U7uUvgJ90cA3doTtdUH0ruVgI5yYbZuBZZaU4xb1ETClnt0Ufn58RcS9x3WRf1pWPmU0j9f8J2NA0oSJKtdu61KkibpvWj56Tn9ZoBkmj2zGTVokmLmI4+mARRztaIwbrBHTBlOBTzX/dqd84bwbJu7vZQe5wGMPq8mshAo5cLMpZtAaEKf+NZiWM=
  - secure: m3LxHKE+74T6HvR2aG4VliQSE0nK2LhGg4CJ7aGvanGSmOwo/OOEqnhEpa5OhAu4f/vhAHeX775sKpFs5lUsr7fzHIdm5Opf4IxnKMa/nW5cvDdDc0m46JJTzPOdlbiqeX365ShvHNznDYZfH81Ws23JdzpQK+9K4OJjtJToEd6lAtdWSOdLXOOBAfdc5T0dRYZREcu+Ljhoi2tWeuSSPkZNQMZnizHZzzecpsA6aCliArvRWzLp9LVr7XrP0fNhk43C8wJSewR+oBWZBZIfRCAWejbVPcKbWKayoFK7gQkAqM4p8MlQKBaX75YYYBCCBFY/xhWlttSXK3uV8pbZgOcemQd2G6XH0vmx6l/6rKnPvHhvhrx/W0+2F4BVNHhklqGu8LEQ3CkFE30JjlyiIxLYAwoP6dmSqOUsrbx+nxZHL8rg2Jms7frgvgD2jjxKSA1X4ScIZ2+jRck3vEqxMBXoBVmwdUJBoWmgNppsz1xyAbIw9PjMoyPv/9utieHcBW+65JVhhcJ5VGwqS5iNeCpoSWotfo8YdJn0PvNlNkRv+wAru0XXT09p1EGtZ8ovwfafew7oKzyVHx6P9gB8zWB71tJkd368UZG+B0AwOALUReVXD+eiqQkAkvuK/hsFksJqFxLCwywManl/KW4YGwvncD8C578b151yPJcG5HA=
  - secure: lKulfhqfXrbaGh9dOyhA/J9XUO27pVxjBXh5FnLHC38qalGO7nQCz4Z+rlNSZ3wnrXwW0MuBnWOvTLw4/ifRpPB+U2iObIwgbqBc1qa2itHrKLBp7y7wSc/6ZTjdf8+kPHtZeU4Dr/ALWw28sdVhy75k9PsZ3kRRNSf7MGfFFqCRZxg2Zh5y+WqFThQptoVFpzgdZ7DG1AJ6v2/mgIpgBgBLNsw4hNVY21bs/w3le7LNIgCP1gICaEOoDWwKCQcS+iByOqs7RGIBUNlVjpjXPyeHTG8XhPLdycyuhkwGstcrYNNed0DaDFelLCiSwjfWBpDAb4Z4b7Ci+5vFFa9JnbjuZ0MoAfKAFI+qm5jWA4LCgPjxlCMOOTQfJM1eafVRFOSajXi7tLwT8D+574ZmITyAzlAJtZUzijMSX0xKLVSsih4K9YLfbbcvF4qFVtLpVGWka6rjeCnGvHKe1A4/dRz/iyIKn9tsGkWQ4gF7sxl85heE9k12jLYILgV83rsHBwYPPQe5C3pSLYXVhfvTZH6LmDHBpFSNiG4INZshBP8n8Z6UWeHFavopHNicYr/UcvisXdHJFs8j5T6wvMrX8Bf68vQoiAQPUY9TEM3n2wEPRlyIUnQXnnVAZtj5xWl4MKwoTHSVUPO9k56gGfUFgE5ka3gUzrx6KS94a/Un2T4=
